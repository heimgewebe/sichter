#!/usr/bin/env bash
set -euo pipefail

ROOT="$(cd "$(dirname "$0")/.." && pwd)"
LOG_DIR="$HOME/sichter/logs"
mkdir -p "$LOG_DIR"

echo "Sichter Dashboard (TUI)" | tee -a "$LOG_DIR/dashboard.log"
echo "==========================" | tee -a "$LOG_DIR/dashboard.log"
echo "API Status: $(curl -fsS localhost:5055/healthz 2>/dev/null || echo offline)" | tee -a "$LOG_DIR/dashboard.log"
echo "Worker Queue: $(find "${XDG_STATE_HOME:-$HOME/.local/state}/sichter/queue" -type f 2>/dev/null | wc -l)" | tee -a "$LOG_DIR/dashboard.log"
echo "Events: $(find "${XDG_STATE_HOME:-$HOME/.local/state}/sichter/events" -type f 2>/dev/null | wc -l)" | tee -a "$LOG_DIR/dashboard.log"
