#!/usr/bin/env bash
set -euo pipefail
# usage: b64write <zielpfad> [mode]
dst="$1"
mode="${2:-0644}"
tmp="$(mktemp)"
cat >"$tmp.b64"
base64 -d "$tmp.b64" >"$tmp.new"
chmod "$mode" "$tmp.new"
mkdir -p "$(dirname "$dst")"
mv "$tmp.new" "$dst"
rm -f "$tmp.b64"
