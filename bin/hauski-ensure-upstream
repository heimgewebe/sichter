#!/usr/bin/env bash
set -euo pipefail

# Source the shared library
# shellcheck source=lib/common.sh
source "$(dirname "$0")/../lib/common.sh"

if git rev-parse --is-inside-work-tree >/dev/null 2>&1; then
	BRANCH="$(git rev-parse --abbrev-ref HEAD)"
	if ! validate_name "${BRANCH}"; then
		echo "Error: Invalid branch name." >&2
		exit 1
	fi
	if ! git rev-parse --verify "@{u}" >/dev/null 2>&1; then
		git push -u origin "${BRANCH}" || true
	fi
fi
